{
  "enabled": true,
  "name": "Security Scanner",
  "description": "DÃ©tecte les failles de sÃ©curitÃ© : secrets exposÃ©s, XSS, validation manquante, mauvaises pratiques",
  "version": "1",
  "when": {
    "type": "userTriggered"
  },
  "then": {
    "type": "askAgent",
    "prompt": "Fichiers modifiÃ©s. Analyse de sÃ©curitÃ© selon les standards du projet :\n\n**Failles Critiques Ã  DÃ©tecter** :\n\n1. **Secrets ExposÃ©s** :\n   - âŒ ClÃ©s API, tokens, mots de passe en dur\n   - âŒ Credentials dans le code (DB_PASSWORD, JWT_SECRET)\n   - âœ… Utilisation de variables d'environnement (.env)\n\n2. **VulnÃ©rabilitÃ©s XSS** :\n   - âŒ `innerHTML` avec donnÃ©es utilisateur\n   - âŒ `eval()`, `Function()` avec input non validÃ©\n   - âœ… `textContent`, `setAttribute()` pour donnÃ©es utilisateur\n   - âœ… Sanitization des entrÃ©es\n\n3. **Validation Manquante** :\n   - âŒ Pas de validation cÃ´tÃ© serveur\n   - âŒ Confiance aveugle dans les donnÃ©es client\n   - âœ… Validation cÃ´tÃ© client ET serveur\n   - âœ… Ã‰chappement des donnÃ©es utilisateur\n\n4. **Mauvaises Pratiques** :\n   - âŒ `console.log()` au lieu de Winston Logger\n   - âŒ Logs contenant des donnÃ©es sensibles\n   - âŒ Fichiers .env commitÃ©s (vÃ©rifier .gitignore)\n   - âŒ CORS trop permissif\n\n5. **Injection SQL/NoSQL** :\n   - âŒ ConcatÃ©nation de requÃªtes avec input utilisateur\n   - âœ… RequÃªtes paramÃ©trÃ©es, ORM sÃ©curisÃ©\n\n**Patterns Ã  Rechercher** :\n```javascript\n// âŒ Dangereux\nelement.innerHTML = userInput;\neval(userCode);\nconst query = `SELECT * FROM users WHERE id = ${userId}`;\nconst password = \"hardcoded123\";\n\n// âœ… SÃ©curisÃ©\nelement.textContent = userInput;\nconst sanitized = DOMPurify.sanitize(userInput);\nconst query = db.prepare(\"SELECT * FROM users WHERE id = ?\").get(userId);\nconst password = process.env.DB_PASSWORD;\n```\n\n**Actions** :\n1. Scanne les patterns dangereux\n2. VÃ©rifie l'utilisation de Winston Logger\n3. DÃ©tecte les secrets potentiels\n4. Identifie les failles XSS\n5. Propose des corrections sÃ©curisÃ©es\n\nRapporte UNIQUEMENT les problÃ¨mes de sÃ©curitÃ© dÃ©tectÃ©s avec leur niveau de criticitÃ© (ğŸ”´ Critique, ğŸŸ  Important, ğŸŸ¡ Attention) et des solutions concrÃ¨tes."
  }
}