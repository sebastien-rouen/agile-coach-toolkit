<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skills Matrix</title>

    <!-- CSS Files -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/matrix.css">
    <link rel="stylesheet" href="css/radar.css">
    <link rel="stylesheet" href="css/modal.css">
    <link rel="stylesheet" href="css/advice.css">
    <link rel="stylesheet" href="css/mobile.css">
    <link rel="stylesheet" href="css/notifications.css">
    <link rel="stylesheet" href="css/share.css">
    <link rel="stylesheet" href="css/import-prompt.css">

    <!-- Theme Light (optionnel) -->
    <link rel="stylesheet" href="css/theme-light.css">
</head>

<body>
    <div class="container">
        <h1>ğŸ“Š Skills Matrix</h1>
        <div class="matrix-header">
            <div class="matrix-name-container">
                <span id="matrixName" class="matrix-name"></span>
                <button id="editMatrixName" onclick="editMatrixName()" class="btn-icon-small"
                    title="Modifier le nom de la matrice">âœï¸</button>
            </div>
            <button id="newMatrixBtn" onclick="createNewMatrix()" class="btn-new-matrix"
                title="CrÃ©er une nouvelle matrice">
                <span class="btn-icon">â•</span>
                <span>Matrice</span>
            </button>
        </div>

        <!-- Menu Mobile Compact -->
        <div class="mobile-menu">
            <!-- Loader Mobile -->
            <div class="mobile-menu-loader" id="mobileMenuLoader">
                <div class="mobile-menu-loader-spinner"></div>
                <div class="mobile-menu-loader-text" id="mobileMenuLoaderText">Chargement...</div>
            </div>
            <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">
                <span>â˜°</span>
                <span>Menu Actions</span>
            </button>
            <div class="mobile-menu-content" id="mobileMenuContent">
                <!-- Menu items will be added here -->
            </div>
        </div>

        <!-- Menu de sÃ©lection de template pour mobile -->
        <select id="mobileTemplateSelect" style="display: none;">
            <option value="">-- Choisir un modÃ¨le --</option>
            <!-- Templates chargÃ©s dynamiquement depuis templates.js -->
        </select>

        <!-- ContrÃ´les Desktop -->
        <div class="controls">
            <!-- Loader -->
            <div class="controls-loader" id="controlsLoader">
                <div class="controls-loader-spinner"></div>
                <div class="controls-loader-text" id="controlsLoaderText">Chargement...</div>
            </div>
            <!-- Groupe 1: Template -->
            <div class="controls-group">
                <div class="template-selector">
                    <select id="templateSelect">
                        <option value="">ğŸ“‹ Charger un modÃ¨le</option>
                        <!-- Templates chargÃ©s dynamiquement depuis templates.js -->
                    </select>
                </div>
            </div>

            <div class="controls-divider"></div>

            <!-- Groupe 2: SÃ©lection & Partage -->
            <div class="controls-group">
                <div class="member-selector-control" id="memberSelectorControl">
                    <button class="btn btn-selector" id="memberSelectorBtn">
                        <span class="btn-icon">ğŸ‘¥</span> Filtrer par membre <span class="btn-arrow">â–¼</span>
                    </button>
                    <div class="member-selector-dropdown" id="memberSelectorDropdown"></div>
                </div>

                <button class="btn" id="shareBtn" onclick="handleShareClick()">
                    <span class="btn-icon">ğŸ”—</span> Partager
                </button>
            </div>

            <div class="controls-divider"></div>

            <!-- Groupe 3: Ajout -->
            <div class="controls-group">
                <button class="btn" onclick="addMember()">
                    <span class="btn-icon">ğŸ‘¤</span> + Membre
                </button>
                <button class="btn" onclick="manageSkills()">
                    <span class="btn-icon">ğŸ¯</span> CompÃ©tences
                </button>
                <button class="btn" onclick="manageAppetencesOwnerships()">
                    <span class="btn-icon">âš¡</span> AppÃ©tences
                </button>
            </div>

            <div class="controls-divider"></div>

            <!-- Groupe 4: Actions -->
            <div class="controls-group">
                <div class="actions-dropdown-control" id="actionsDropdownControl">
                    <button class="btn btn-success" id="actionsDropdownBtn">
                        <span class="btn-icon">ğŸ’¾</span> Actions <span class="btn-arrow">â–¼</span>
                    </button>
                    <div class="actions-dropdown" id="actionsDropdown">
                        <button class="dropdown-item" onclick="saveData(true); closeActionsDropdown()">
                            <span class="btn-icon">ğŸ’¾</span> Sauvegarder
                        </button>
                        <div class="dropdown-separator"></div>
                        <button class="dropdown-item" onclick="exportToJSON(); closeActionsDropdown()">
                            <span class="btn-icon">ğŸ“¥</span> Export JSON
                        </button>
                        <button class="dropdown-item" onclick="exportToXLSX(); closeActionsDropdown()">
                            <span class="btn-icon">ğŸ“Š</span> Export Excel
                        </button>
                        <div class="dropdown-separator"></div>
                        <button class="dropdown-item" onclick="importFromJSON(); closeActionsDropdown()">
                            <span class="btn-icon">ğŸ“¤</span> Import JSON
                        </button>
                        <button class="dropdown-item" onclick="importFromXLSX(); closeActionsDropdown()">
                            <span class="btn-icon">ğŸ“ˆ</span> Import Excel
                        </button>
                    </div>
                </div>
            </div>

            <div class="controls-divider"></div>

            <!-- Groupe 5: Reset -->
            <div class="controls-group">
                <button class="btn btn-danger" onclick="resetMatrix()">
                    <span class="btn-icon">ğŸ”„</span> RÃ©initialiser
                </button>
            </div>
        </div>

        <!-- Legend -->
        <div class="legend">
            <div class="legend-item level-1">
                <strong>1 DÃ©butant</strong><br>
                Aucune compÃ©tence - Formation nÃ©cessaire
            </div>
            <div class="legend-item level-2">
                <strong>2 Apprentissage</strong><br>
                CompÃ©tence faible - Support rÃ©gulier requis
            </div>
            <div class="legend-item level-3">
                <strong>3 CompÃ©tent</strong><br>
                Bon niveau - Support occasionnel nÃ©cessaire
            </div>
            <div class="legend-item level-4">
                <strong>4 Expert</strong><br>
                MaÃ®trise complÃ¨te - Travail en autonomie
            </div>
        </div>

        <!-- Matrix -->
        <div class="matrix-container">
            <table id="skillsMatrix">
                <thead>
                    <tr id="headerRow">
                        <th>Personnel / CompÃ©tences</th>
                    </tr>
                </thead>
                <tbody id="matrixBody"></tbody>
            </table>
        </div>

        <!-- Radar Section -->
        <div class="radar-section">
            <h2>ğŸ“ˆ Radar des CompÃ©tences</h2>
            <div class="member-selector" id="memberSelector"></div>
            <div class="radar-container">
                <div class="radar-canvas-wrapper">
                    <canvas id="radarCanvas" width="800" height="800"></canvas>
                </div>
                <div class="radar-legend-wrapper">
                    <div class="radar-legend" id="radarLegend"></div>
                </div>
            </div>
        </div>

        <!-- Advice Section -->
        <div class="advice-section">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0;">ğŸ’¡ Conseils PersonnalisÃ©s - Coach Sticko</h2>
                <button class="btn" onclick="exportAdviceToMarkdown()" title="Exporter les conseils en Markdown">
                    <span class="btn-icon">ğŸ“</span> Export Markdown
                </button>
            </div>
            <div class="advice-controls">
                <div class="advice-view-toggle">
                    <button class="view-btn active" onclick="switchAdviceView('member', this)">
                        <span class="btn-icon">ğŸ‘¤</span> Par Membre
                    </button>
                    <button class="view-btn" onclick="switchAdviceView('skill', this)">
                        <span class="btn-icon">ğŸ¯</span> Par CompÃ©tence
                    </button>
                </div>
                <div class="advice-filter">
                    <button class="filter-btn active" onclick="filterAdvice('all', this)">Tous</button>
                    <button class="filter-btn" onclick="filterAdvice('beginner', this)">DÃ©butants</button>
                    <button class="filter-btn" onclick="filterAdvice('learning', this)">En apprentissage</button>
                    <button class="filter-btn" onclick="filterAdvice('competent', this)">CompÃ©tents</button>
                </div>
            </div>
            <div class="advice-cards" id="adviceCards"></div>
        </div>

        <!-- Strategic Advice Section -->
        <div class="advice-section strategic-advice-section">
            <h2>ğŸ“Š Conseils StratÃ©giques d'Ã‰quipe</h2>
            <div class="strategic-advice-cards" id="strategicAdviceCards"></div>
        </div>
    </div>

    <!-- Modal AppÃ©tences & Ownerships -->
    <div class="modal-overlay" id="appetencesModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ğŸ¯ GÃ©rer AppÃ©tences & Ownerships</h2>
                <button class="modal-close" onclick="closeAppetencesModal()">Ã—</button>
            </div>
            <div id="modalMembersContent"></div>
        </div>
    </div>

    <!-- Modal Gestion des CompÃ©tences -->
    <div class="modal-overlay" id="skillsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ğŸ¯ GÃ©rer les CompÃ©tences</h2>
                <button class="modal-close" onclick="closeSkillsModal()">Ã—</button>
            </div>
            <div id="modalSkillsContent"></div>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/loader.js"></script>
    <script src="js/import-prompt.js"></script>
    <script src="js/templates.js"></script>
    <script src="js/data.js"></script>
    <script src="js/matrix.js"></script>
    <script src="js/radar.js"></script>
    <script src="js/advice.js"></script>
    <script src="js/strategic-advice.js"></script>
    <script src="js/modal.js"></script>
    <script src="js/modal-single-member.js"></script>
    <script src="js/share.js"></script>
    <script src="js/autocomplete.js"></script>
    <script src="js/main.js"></script>

    <!-- PocketBase Integration -->
    <script src="../../assets/js/pocketbase-manager.js"></script>
    <script src="js/pocketbase-integration.js"></script>

    <!-- IntÃ©gration Agile Coach Toolkit -->
    <script src="../../assets/js/tool-integration.js"></script>
    <script>
        window.TOOL_CONFIG = {
            name: 'skills-matrix',
            backUrl: '../../index.html#tools'
        };
    </script>
</body>

</html>