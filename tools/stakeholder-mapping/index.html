<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stakeholder Mapping</title>

    <!-- CSS Files -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/table-view.css">
    <link rel="stylesheet" href="css/circles-view.css">
    <link rel="stylesheet" href="css/matrix-view.css">
    <link rel="stylesheet" href="css/modal.css">
    <link rel="stylesheet" href="css/theme-light.css">
</head>

<body>
    <!-- Sidebar Toggle Button -->
    <button class="sidebar-toggle" id="sidebarToggle" title="Guide & Lexique">
        <span class="sidebar-toggle-icon">üìñ</span>
    </button>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>üìñ Guide & Lexique</h2>
            <div class="sidebar-header-actions">
                <button class="sidebar-pin" id="sidebarPin" title="√âpingler la sidebar">
                    <span class="pin-icon">üìå</span>
                </button>
                <button class="sidebar-close" id="sidebarClose">√ó</button>
            </div>
        </div>
        <div class="sidebar-content">
            <div class="sidebar-section">
                <h3>üìñ D√©finitions</h3>
                <div class="lexique-item">
                    <strong>Pouvoir</strong>
                    <p>Capacit√© d'une partie prenante √† influencer les d√©cisions et l'orientation du projet.</p>
                </div>
                <div class="lexique-item">
                    <strong>Int√©r√™t</strong>
                    <p>Niveau d'attention et d'engagement qu'une partie prenante porte au projet et √† ses r√©sultats.</p>
                </div>
                <div class="lexique-item">
                    <strong>Influence</strong>
                    <p>Impact global qu'une partie prenante peut avoir sur la r√©ussite ou l'√©chec du projet.</p>
                </div>
                <div class="lexique-item">
                    <strong>Domaine</strong>
                    <p>Cat√©gorie fonctionnelle √† laquelle appartient la partie prenante (Gouvernance, Client,
                        Fournisseur, Influenceur).</p>
                </div>
            </div>

            <div class="sidebar-section">
                <h3>üéØ Niveaux d'Influence</h3>
                <div class="influence-items">
                    <div class="influence-item vital">
                        <div class="influence-badge">Vital</div>
                        <p>Impact critique sur le projet</p>
                    </div>
                    <div class="influence-item necessary">
                        <div class="influence-badge">N√©cessaire</div>
                        <p>Influence importante</p>
                    </div>
                    <div class="influence-item good">
                        <div class="influence-badge">Bon</div>
                        <p>Influence mod√©r√©e</p>
                    </div>
                    <div class="influence-item courtesy">
                        <div class="influence-badge">Courtoisie</div>
                        <p>Influence limit√©e</p>
                    </div>
                </div>
            </div>

            <div class="sidebar-section">
                <h3>üìä Domaines</h3>
                <div class="domain-items">
                    <div class="domain-item governance">
                        <div class="domain-badge">üëë Gouvernance</div>
                        <p>D√©cisions strat√©giques</p>
                    </div>
                    <div class="domain-item customer">
                        <div class="domain-badge">üë• Client</div>
                        <p>Utilisateurs finaux</p>
                    </div>
                    <div class="domain-item provider">
                        <div class="domain-badge">ü§ù Fournisseur</div>
                        <p>Partenaires externes</p>
                    </div>
                    <div class="domain-item influencer">
                        <div class="domain-badge">üí° Influenceur</div>
                        <p>Leaders d'opinion</p>
                    </div>
                </div>
            </div>

            <div class="sidebar-section">
                <h3>üöÄ Guide d'Animation Rapide</h3>
                <div class="animation-steps">
                    <div class="step">
                        <span class="step-number">1</span>
                        <div class="step-content">
                            <strong>Brainstorming (10 min)</strong>
                            <p>Listez toutes les parties prenantes potentielles sur des post-its.</p>
                        </div>
                    </div>
                    <div class="step">
                        <span class="step-number">2</span>
                        <div class="step-content">
                            <strong>Cat√©gorisation (5 min)</strong>
                            <p>Regroupez par domaine : Gouvernance, Client, Fournisseur, Influenceur.</p>
                        </div>
                    </div>
                    <div class="step">
                        <span class="step-number">3</span>
                        <div class="step-content">
                            <strong>√âvaluation (10 min)</strong>
                            <p>Pour chaque partie prenante, √©valuez Pouvoir (1-5) et Int√©r√™t (1-5).</p>
                        </div>
                    </div>
                    <div class="step">
                        <span class="step-number">4</span>
                        <div class="step-content">
                            <strong>Priorisation (5 min)</strong>
                            <p>Placez dans la matrice et d√©finissez la strat√©gie d'engagement.</p>
                        </div>
                    </div>
                    <div class="step">
                        <span class="step-number">5</span>
                        <div class="step-content">
                            <strong>Plan d'Action (10 min)</strong>
                            <p>D√©finissez la fr√©quence et le type de communication pour chaque quadrant.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <div class="container">
        <header class="header">
            <h1>üéØ Stakeholder Mapping</h1>
            <div class="header-actions">
                <button id="newSessionBtn" class="btn btn-primary">
                    <span class="btn-icon">‚ûï</span> Nouvelle Session
                </button>
            </div>
        </header>

        <!-- Session Info -->
        <div class="session-info" id="sessionInfo">
            <div class="session-name-container">
                <span id="sessionName" class="session-name"></span>
                <button id="editSessionName" class="btn-icon-small" title="Modifier le nom de la session">‚úèÔ∏è</button>
            </div>

            <div class="session-actions">
                <!-- Groupe 2: Actions -->
                <div class="controls-group">
                    <span class="controls-label">‚öôÔ∏è Actions</span>
                    <button class="btn btn-secondary" id="templatesBtn">
                        <span class="btn-icon">üìã</span>
                        <span class="btn-text">Templates</span>
                    </button>
                    <button class="btn btn-primary" id="addStakeholderBtn">
                        <span class="btn-icon">üë§</span>
                        <span class="btn-text">Ajouter</span>
                    </button>
                    <button class="btn btn-success" id="saveBtn">
                        <span class="btn-icon">üíæ</span>
                        <span class="btn-text">Sauvegarder</span>
                    </button>
                </div>

                <div class="controls-divider"></div>

                <!-- Groupe 3: Import/Export -->
                <div class="controls-group">
                    <span class="controls-label">üîó Partage</span>
                    <button class="btn btn-secondary" id="importBtn">
                        <span class="btn-icon">üì•</span>
                        <span class="btn-text">Importer</span>
                    </button>
                    <button class="btn btn-secondary" id="exportBtn">
                        <span class="btn-icon">üì§</span>
                        <span class="btn-text">Exporter</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <!-- Groupe 1: Vues -->
            <div class="controls-group">
                <span class="controls-label">üìä Vues</span>
                <div class="btn-group">
                    <button class="btn btn-view active" data-view="table">
                        <span class="btn-icon">üìã</span>
                        <span class="btn-text">Tableau</span>
                    </button>
                    <button class="btn btn-view" data-view="circles">
                        <span class="btn-icon">üéØ</span>
                        <span class="btn-text">Cercles</span>
                    </button>
                    <button class="btn btn-view" data-view="matrix">
                        <span class="btn-icon">üìä</span>
                        <span class="btn-text">Matrice</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Views Container -->
        <div class="views-container">
            <!-- Table View -->
            <div id="tableView" class="view-content active">
                <div class="table-container">
                    <table id="stakeholdersTable">
                        <thead>
                            <tr>
                                <th>Nom</th>
                                <th>R√¥le</th>
                                <th>Pouvoir</th>
                                <th>Int√©r√™t</th>
                                <th>Influence</th>
                                <th>Domaine</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- Circles View -->
            <div id="circlesView" class="view-content">
                <div class="circles-container">
                    <svg id="circlesSvg" viewBox="0 0 800 800"></svg>
                    <div class="circles-legend">
                        <div class="circles-legend-item">
                            <div class="circle-sample vital"></div>
                            <span>Vital</span>
                        </div>
                        <div class="circles-legend-item">
                            <div class="circle-sample necessary"></div>
                            <span>N√©cessaire</span>
                        </div>
                        <div class="circles-legend-item">
                            <div class="circle-sample good"></div>
                            <span>Bon</span>
                        </div>
                        <div class="circles-legend-item">
                            <div class="circle-sample courtesy"></div>
                            <span>Courtoisie</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Matrix View -->
            <div id="matrixView" class="view-content">
                <div class="matrix-container">
                    <div class="matrix-grid">
                        <div class="matrix-quadrant high-power-low-interest">
                            <h3>Garder Satisfait</h3>
                            <p>Pouvoir √âlev√©, Int√©r√™t Faible</p>
                            <div class="quadrant-stakeholders" data-quadrant="high-low"></div>
                        </div>
                        <div class="matrix-quadrant high-power-high-interest">
                            <h3>Le Plus Important</h3>
                            <p>Pouvoir √âlev√©, Int√©r√™t √âlev√©</p>
                            <div class="quadrant-stakeholders" data-quadrant="high-high"></div>
                        </div>
                        <div class="matrix-quadrant low-power-low-interest">
                            <h3>Le Moins Important</h3>
                            <p>Pouvoir Faible, Int√©r√™t Faible</p>
                            <div class="quadrant-stakeholders" data-quadrant="low-low"></div>
                        </div>
                        <div class="matrix-quadrant low-power-high-interest">
                            <h3>Tenir Inform√©</h3>
                            <p>Pouvoir Faible, Int√©r√™t √âlev√©</p>
                            <div class="quadrant-stakeholders" data-quadrant="low-high"></div>
                        </div>
                    </div>
                    <div class="matrix-axes">
                        <div class="axis-label axis-x">Int√©r√™t de la partie prenante ‚Üí</div>
                        <div class="axis-label axis-y">‚Üë Pouvoir de la partie prenante</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Add/Edit Stakeholder -->
    <div class="modal-overlay" id="stakeholderModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">‚ûï Ajouter un Stakeholder</h2>
                <button class="modal-close" id="closeModal">√ó</button>
            </div>
            <form id="stakeholderForm" novalidate>
                <input type="hidden" id="stakeholderId">

                <!-- Section 1: Identit√© -->
                <div class="form-section">
                    <h3 class="form-section-title">üë§ Identit√©</h3>

                    <div class="form-group">
                        <label for="stakeholderName">Nom *</label>
                        <input type="text" id="stakeholderName" required placeholder="Ex: Jean Dupont">
                        <span class="form-error" id="nameError"></span>
                    </div>

                    <div class="form-group">
                        <label for="stakeholderRole">R√¥le *</label>
                        <input type="text" id="stakeholderRole" required placeholder="Ex: Product Owner">
                        <span class="form-error" id="roleError"></span>
                    </div>
                </div>

                <!-- Section 2: √âvaluation -->
                <div class="form-section">
                    <h3 class="form-section-title">üìä √âvaluation</h3>

                    <div class="form-group">
                        <label for="stakeholderPower">Pouvoir *</label>
                        <div class="number-selector">
                            <button type="button" class="number-btn" data-field="power" data-value="1">1</button>
                            <button type="button" class="number-btn" data-field="power" data-value="2">2</button>
                            <button type="button" class="number-btn" data-field="power" data-value="3">3</button>
                            <button type="button" class="number-btn" data-field="power" data-value="4">4</button>
                            <button type="button" class="number-btn" data-field="power" data-value="5">5</button>
                        </div>
                        <input type="hidden" id="stakeholderPower" required>
                        <small>1 = Faible, 5 = Tr√®s √©lev√©</small>
                        <span class="form-error" id="powerError"></span>
                    </div>

                    <div class="form-group">
                        <label for="stakeholderInterest">Int√©r√™t *</label>
                        <div class="number-selector">
                            <button type="button" class="number-btn" data-field="interest" data-value="1">1</button>
                            <button type="button" class="number-btn" data-field="interest" data-value="2">2</button>
                            <button type="button" class="number-btn" data-field="interest" data-value="3">3</button>
                            <button type="button" class="number-btn" data-field="interest" data-value="4">4</button>
                            <button type="button" class="number-btn" data-field="interest" data-value="5">5</button>
                        </div>
                        <input type="hidden" id="stakeholderInterest" required>
                        <small>1 = Faible, 5 = Tr√®s √©lev√©</small>
                        <span class="form-error" id="interestError"></span>
                    </div>
                </div>

                <!-- Section 3: Cat√©gorisation -->
                <div class="form-section">
                    <h3 class="form-section-title">üéØ Cat√©gorisation</h3>

                    <div class="form-group">
                        <label for="stakeholderInfluence">Niveau d'Influence *</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="influence" value="vital" required>
                                <span class="radio-label">
                                    <span class="radio-icon" style="background: var(--color-vital)"></span>
                                    <span class="radio-text">
                                        <strong>Vital</strong>
                                        <small>Impact critique</small>
                                    </span>
                                </span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="influence" value="necessary" required>
                                <span class="radio-label">
                                    <span class="radio-icon" style="background: var(--color-necessary)"></span>
                                    <span class="radio-text">
                                        <strong>N√©cessaire</strong>
                                        <small>Influence importante</small>
                                    </span>
                                </span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="influence" value="good" required>
                                <span class="radio-label">
                                    <span class="radio-icon" style="background: var(--color-good)"></span>
                                    <span class="radio-text">
                                        <strong>Bon</strong>
                                        <small>Influence mod√©r√©e</small>
                                    </span>
                                </span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="influence" value="courtesy" required>
                                <span class="radio-label">
                                    <span class="radio-icon" style="background: var(--color-courtesy)"></span>
                                    <span class="radio-text">
                                        <strong>Courtoisie</strong>
                                        <small>Influence limit√©e</small>
                                    </span>
                                </span>
                            </label>
                        </div>
                        <input type="hidden" id="stakeholderInfluence" required>
                        <span class="form-error" id="influenceError"></span>
                    </div>

                    <div class="form-group">
                        <label for="stakeholderDomain">Domaine *</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="domain" value="governance" required>
                                <span class="radio-label">
                                    <span class="radio-icon" style="background: var(--color-governance)">üëë</span>
                                    <span class="radio-text">
                                        <strong>Gouvernance</strong>
                                        <small>D√©cisions strat√©giques</small>
                                    </span>
                                </span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="domain" value="customer" required>
                                <span class="radio-label">
                                    <span class="radio-icon" style="background: var(--color-customer)">üë•</span>
                                    <span class="radio-text">
                                        <strong>Client</strong>
                                        <small>Utilisateurs finaux</small>
                                    </span>
                                </span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="domain" value="provider" required>
                                <span class="radio-label">
                                    <span class="radio-icon" style="background: var(--color-provider)">ü§ù</span>
                                    <span class="radio-text">
                                        <strong>Fournisseur</strong>
                                        <small>Partenaires externes</small>
                                    </span>
                                </span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="domain" value="influencer" required>
                                <span class="radio-label">
                                    <span class="radio-icon" style="background: var(--color-influencer)">üí°</span>
                                    <span class="radio-text">
                                        <strong>Influenceur</strong>
                                        <small>Leaders d'opinion</small>
                                    </span>
                                </span>
                            </label>
                        </div>
                        <input type="hidden" id="stakeholderDomain" required>
                        <span class="form-error" id="domainError"></span>
                    </div>
                </div>

                <!-- Section 4: Notes -->
                <div class="form-section">
                    <h3 class="form-section-title">üìù Notes</h3>

                    <div class="form-group">
                        <label for="stakeholderNotes">Informations compl√©mentaires</label>
                        <textarea id="stakeholderNotes" rows="3"
                            placeholder="Strat√©gie d'engagement, points d'attention..."></textarea>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">üíæ Enregistrer</button>
                    <button type="button" class="btn btn-secondary" id="cancelBtn">Annuler</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Templates -->
    <div class="modal-overlay" id="templatesModal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2 class="modal-title">üìã Templates de Contextes</h2>
                <button class="modal-close" id="closeTemplatesModal">√ó</button>
            </div>
            <div class="templates-grid">
                <div class="template-card" data-template="it-ecommerce-scrum">
                    <div class="template-icon">üõí</div>
                    <h3>√âquipe IT E-commerce SCRUM</h3>
                    <p>Product Owner, Scrum Master, D√©veloppeurs, Clients, Fournisseurs</p>
                    <button class="btn btn-primary template-load-btn">Charger</button>
                </div>
                <div class="template-card" data-template="it-ecommerce-kanban">
                    <div class="template-icon">üìä</div>
                    <h3>√âquipe IT E-commerce KANBAN</h3>
                    <p>Team Lead, D√©veloppeurs, Support, Clients, Partenaires</p>
                    <button class="btn btn-primary template-load-btn">Charger</button>
                </div>
                <div class="template-card" data-template="it-scrum-safe">
                    <div class="template-icon">üèóÔ∏è</div>
                    <h3>√âquipe IT SCRUM en SAFe</h3>
                    <p>RTE, Product Manager, Scrum Master, √âquipes, Architectes</p>
                    <button class="btn btn-primary template-load-btn">Charger</button>
                </div>
                <div class="template-card" data-template="rh">
                    <div class="template-icon">üë•</div>
                    <h3>√âquipe RH</h3>
                    <p>DRH, Recruteurs, Managers, Employ√©s, Syndicats</p>
                    <button class="btn btn-primary template-load-btn">Charger</button>
                </div>
                <div class="template-card" data-template="armee">
                    <div class="template-icon">üéñÔ∏è</div>
                    <h3>√âquipe dans l'Arm√©e</h3>
                    <p>Commandant, Officiers, Soldats, √âtat-major, Logistique</p>
                    <button class="btn btn-primary template-load-btn">Charger</button>
                </div>
                <div class="template-card" data-template="medicale">
                    <div class="template-icon">üè•</div>
                    <h3>√âquipe M√©dicale</h3>
                    <p>Chef de service, M√©decins, Infirmiers, Patients, Administration</p>
                    <button class="btn btn-primary template-load-btn">Charger</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Import -->
    <div class="modal-overlay" id="importModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">üì• Import de Donn√©es</h2>
                <button class="modal-close" id="closeImportModal">√ó</button>
            </div>
            <div class="import-options">
                <div class="import-option">
                    <div class="import-icon">üìä</div>
                    <h3>Fichier JSON</h3>
                    <p>Importez une session pr√©c√©dente</p>
                    <label for="jsonFile" class="file-input-label">
                        <span class="file-input-icon">üìÅ</span>
                        <span class="file-input-text">Choisir un fichier</span>
                    </label>
                    <input type="file" id="jsonFile" accept=".json" class="file-input-hidden">
                    <div id="fileNameDisplay" class="file-name-display"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/data.js"></script>
    <script src="js/templates.js"></script>
    <script src="js/table-view.js"></script>
    <script src="js/circles-view.js"></script>
    <script src="js/matrix-view.js"></script>
    <script src="js/modal.js"></script>
    <script src="js/import-export.js"></script>
    <script src="js/app.js"></script>

    <!-- PocketBase Integration -->
    <script src="../../assets/js/pocketbase-manager.js"></script>
    <script src="js/pocketbase-integration.js"></script>

    <!-- Int√©gration Agile Coach Toolkit -->
    <script src="../../assets/js/tool-integration.js"></script>
    <script>
        window.TOOL_CONFIG = {
            name: 'stakeholder-mapping',
            backUrl: '../../index.html#tools'
        };
    </script>
</body>

</html>